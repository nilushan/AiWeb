---
import { getEntry } from 'astro:content';
import BaseLayout from '@/layouts/BaseLayout.astro';
import Hero from '@/components/ui/Hero.astro';
import PageSection from '@/components/PageSection.astro';

// Fetch page content from collection
const page = await getEntry('pages', 'contact');

if (!page) {
  return Astro.redirect('/404');
}

const { title, description, hero, sections = [] } = page.data;
---

<BaseLayout
  title={title.charAt(0).toUpperCase() + title.slice(1)}
  description={description}
>
  <!-- Hero -->
  {hero && (
    <Hero
      title={hero.title}
      subtitle={hero.subtitle}
    />
  )}

  <!-- Dynamic Sections -->
  {sections.map((section, index) => {
    // Special handling for contact form section
    if (section.sectionType === 'contact-methods') {
      return (
        <>
          <PageSection
            section={section}
            className=""
          />

          <!-- Contact Form -->
          <div class="container-custom">
            <div class="max-w-4xl mx-auto">
              <div class="card bg-base-100 shadow-2xl">
                <div class="card-body p-8 md:p-12">
                  <h2 class="card-title text-3xl mb-6">Send us a Message</h2>

                  <form class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                      <div class="form-control">
                        <label class="label">
                          <span class="label-text font-semibold">First Name</span>
                        </label>
                        <input
                          type="text"
                          placeholder="John"
                          class="input input-bordered w-full"
                          required
                        />
                      </div>

                      <div class="form-control">
                        <label class="label">
                          <span class="label-text font-semibold">Last Name</span>
                        </label>
                        <input
                          type="text"
                          placeholder="Doe"
                          class="input input-bordered w-full"
                          required
                        />
                      </div>
                    </div>

                    <div class="form-control">
                      <label class="label">
                        <span class="label-text font-semibold">Email</span>
                      </label>
                      <input
                        type="email"
                        placeholder="john.doe@example.com"
                        class="input input-bordered w-full"
                        required
                      />
                    </div>

                    <div class="form-control">
                      <label class="label">
                        <span class="label-text font-semibold">Company (Optional)</span>
                      </label>
                      <input
                        type="text"
                        placeholder="Acme Inc."
                        class="input input-bordered w-full"
                      />
                    </div>

                    <div class="form-control">
                      <label class="label">
                        <span class="label-text font-semibold">Subject</span>
                      </label>
                      <select class="select select-bordered w-full">
                        <option>General Inquiry</option>
                        <option>Technical Support</option>
                        <option>Sales Question</option>
                        <option>Partnership Opportunity</option>
                        <option>Feature Request</option>
                        <option>Bug Report</option>
                      </select>
                    </div>

                    <div class="form-control">
                      <label class="label">
                        <span class="label-text font-semibold">Message</span>
                      </label>
                      <textarea
                        class="textarea textarea-bordered h-32"
                        placeholder="Tell us how we can help..."
                        required
                      ></textarea>
                    </div>

                    <div class="form-control">
                      <label class="label cursor-pointer justify-start gap-3">
                        <input type="checkbox" class="checkbox checkbox-primary" />
                        <span class="label-text">I agree to receive marketing communications</span>
                      </label>
                    </div>

                    <button type="submit" class="btn btn-primary btn-lg btn-block">
                      Send Message
                    </button>

                    <p class="text-sm text-center text-base-content/60">
                      We typically respond within 24 hours
                    </p>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </>
      );
    }

    // Regular sections
    const className = index % 2 === 0 ? 'bg-base-200' : '';
    return (
      <PageSection
        section={section}
        className={className}
      />
    );
  })}
</BaseLayout>

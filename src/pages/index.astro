---
import { getEntry } from 'astro:content';
import BaseLayout from '@/layouts/BaseLayout.astro';
import Hero from '@/components/ui/Hero.astro';
import Button from '@/components/ui/Button.astro';
import PageSection from '@/components/PageSection.astro';

// Fetch page content from collection
const page = await getEntry('pages', 'home');

if (!page) {
  return Astro.redirect('/404');
}

const { title, description, hero, sections = [] } = page.data;
---

<BaseLayout
  title={title.charAt(0).toUpperCase() + title.slice(1)}
  description={description}
>
  <!-- Hero Section -->
  {hero && (
    <Hero
      title={hero.title}
      subtitle={hero.subtitle}
    >
      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <Button href="/blog" variant="primary" size="lg" wide>
          Get Started
        </Button>
        <Button href="/knowledge-base" variant="secondary" size="lg" wide outline>
          Learn More
        </Button>
      </div>
    </Hero>
  )}

  <!-- Dynamic Sections -->
  {sections.map((section, index) => {
    // Alternate between default and bg-base-200 for visual separation
    const className = index % 2 === 1 ? 'bg-base-200' : '';
    return (
      <PageSection
        section={section}
        className={className}
      />
    );
  })}
</BaseLayout>

---
import { getEntry } from 'astro:content';
import BaseLayout from '@/layouts/BaseLayout.astro';
import Hero from '@/components/ui/Hero.astro';
import PageSection from '@/components/PageSection.astro';

// Fetch page content from collection
const page = await getEntry('pages', 'about');

if (!page) {
  return Astro.redirect('/404');
}

const { title, description, hero, sections = [] } = page.data;
const { Content } = await page.render();
---

<BaseLayout
  title={title.charAt(0).toUpperCase() + title.slice(1)}
  description={description}
>
  <!-- Hero -->
  {hero && (
    <Hero
      title={hero.title}
      subtitle={hero.subtitle}
    />
  )}

  <!-- Mission Section (from markdown content) -->
  <section class="section-padding">
    <div class="container-custom">
      <div class="max-w-4xl mx-auto prose prose-lg mx-auto">
        <Content />
      </div>
    </div>
  </section>

  <!-- Dynamic Sections -->
  {sections.map((section, index) => {
    const isEven = index % 2 === 0;
    return (
      <PageSection
        section={section}
        className={isEven ? 'bg-base-200' : ''}
      />
    );
  })}
</BaseLayout>
